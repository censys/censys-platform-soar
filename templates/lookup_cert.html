{% extends 'base/logo_header.html' %}
{% block title %}Certificate Lookup Results{% endblock %}
{% block widget_content %}
  <style>
  .result-table {
    border-collapse: collapse;
    border: none;
    width: 100%;
  }
  .result-table td {
    border: none;
    padding: 0.4em 0.6em;
    vertical-align: top;
  }
  .result-table td:first-child {
    font-weight: 600;
    white-space: nowrap;
    color: #818d99;
  }
  .result-table td:last-child {
    word-break: break-word;
  }
  .result-table tr:nth-child(odd) {
    background-color: rgba(0, 0, 0, 0.03);
  }
  .result-section {
    margin-bottom: 2em;
  }
  .result-section:last-child {
    margin-bottom: 0;
  }
  </style>
  <div class="cs-cert-info"
       style="overflow: auto;
              width: 100%;
              height: 100%;
              padding-left:10px;
              padding-right:10px">
    {% for result in results %}
      <div class="result-section">
        <table class="result-table">
          <tbody>
            <tr class="field-row">
              <td>Fingerprint (SHA256)</td>
              <td>{{ result.fingerprint_sha256 }}</td>
            </tr>
            <tr class="field-row">
              <td>Display Name</td>
              <td>{{ result.display_name }}</td>
            </tr>
            {% if result.subject_dn and result.subject_dn != "N/A" %}
              <tr class="field-row">
                <td>Subject DN</td>
                <td>{{ result.subject_dn }}</td>
              </tr>
            {% endif %}
            {% if result.issuer_dn and result.issuer_dn != "N/A" %}
              <tr class="field-row">
                <td>Issuer DN</td>
                <td>{{ result.issuer_dn }}</td>
              </tr>
            {% endif %}
            {% if result.common_names %}
              <tr class="field-row">
                <td>Common Names</td>
                <td>{{ result.common_names|join(", ") }}</td>
              </tr>
            {% endif %}
            {% if result.valid_from and result.valid_from != "N/A" %}
              <tr class="field-row">
                <td>Valid From</td>
                <td>{{ result.valid_from }}</td>
              </tr>
            {% endif %}
            {% if result.valid_to and result.valid_to != "N/A" %}
              <tr class="field-row">
                <td>Valid To</td>
                <td>{{ result.valid_to }}</td>
              </tr>
            {% endif %}
            {% if result.self_signed and result.self_signed != "Unknown" %}
              <tr class="field-row">
                <td>Self-Signed</td>
                <td>{{ result.self_signed }}</td>
              </tr>
            {% endif %}
          </tbody>
        </table>
      </div>
    {% endfor %}
  </div>
{% endblock %}
